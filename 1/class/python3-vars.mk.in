# -*- mode: makefile; coding: utf-8 -*-
# Copyright © 2003 Colin Walters <walters@debian.org>
# Copyright © 2006 Marc Dequènes (Duck) <Duck@DuckCorp.org>
# Copyright © 2003,2006-2009 Jonas Smedegaard <dr@jones.dk>
# Description: Common variables for Python packages
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2, or (at
# your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

#PATH_RULES#

ifndef _cdbs_class_python3_vars
_cdbs_class_python3_vars = 1

include $(_cdbs_rules_path)/buildvars.mk$(_cdbs_makefile_suffix)
include $(_cdbs_class_path)/langcore.mk$(_cdbs_makefile_suffix)

cdbs_python3_packages = $(or $(DEB_PYTHON3_MODULE_PACKAGES),$(firstword $(filter-out %-doc %-dev %-common python-%, $(DEB_PACKAGES))))
cdbs_python3_arch_packages = $(filter $(cdbs_python3_packages), $(DEB_ARCH_PACKAGES))
cdbs_python3_indep_packages = $(filter $(cdbs_python3_packages), $(DEB_INDEP_PACKAGES))

cdbs_python3_destdir = $(or $(DEB_PYTHON3_DESTDIR),$(DEB_DESTDIR))

# Calculate cdbs_python3_build_versions
cdbs_python3_current_version := $(shell py3versions -vd)
cdbs_python3_supported_versions := $(shell py3versions -vr)
cdbs_python3_first_supported_version = $(firstword $(strip $(sort $(cdbs_python3_supported_versions))))
# Non-default Python version used (only valid for arch-indendent builds)
# arch(+indep): 3; indep: 3 if current is supported, else first supported
cdbs_python3_nondefault_version = $(if $(cdbs_python3_arch_packages),3,$(if $(filter $(cdbs_python3_current_version),$(cdbs_python3_supported_versions)),3,$(cdbs_python3_first_supported_version)))
cdbs_python3_build_versions = $(or $(if $(cdbs_python3_arch_packages),$(cdbs_python3_supported_versions)))

endif
